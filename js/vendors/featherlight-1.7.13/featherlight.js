(function(d){function g(a,b){if(this instanceof g)this.id=g.id++,this.setup(a,b),this.chainCallbacks(g._callbackChain);else{var c=new g(a,b);c.open();return c}}function r(a,b){var c={},d;for(d in a)d in b&&(c[d]=a[d],delete a[d]);return c}function t(a,b){var c={},d=new RegExp("^"+b+"([A-Z])(.*)"),f;for(f in a){var h=f.match(d);h&&(h=(h[1]+h[2].replace(/([A-Z])/g,"-$1")).toLowerCase(),c[h]=a[f])}return c}if("undefined"===typeof d)"console"in window&&window.console.info("Too much lightness, Featherlight needs jQuery.");
else if(d.fn.jquery.match(/-ajax/))"console"in window&&window.console.info("Featherlight needs regular jQuery, not the slim version.");else{var k=[],n=function(a){return k=d.grep(k,function(b){return b!==a&&0<b.$instance.closest("body").length})},u={allow:1,allowfullscreen:1,frameborder:1,height:1,longdesc:1,marginheight:1,marginwidth:1,mozallowfullscreen:1,name:1,referrerpolicy:1,sandbox:1,scrolling:1,src:1,srcdoc:1,style:1,webkitallowfullscreen:1,width:1},p={keyup:"onKeyUp",resize:"onResize"},v=
function(a){d.each(g.opened().reverse(),function(){if(!a.isDefaultPrevented()&&!1===this[p[a.type]](a))return a.preventDefault(),a.stopPropagation(),!1})},q=function(a){if(a!==g._globalHandlerInstalled){g._globalHandlerInstalled=a;var b=d.map(p,function(a,b){return b+"."+g.prototype.namespace}).join(" ");d(window)[a?"on":"off"](b,v)}};g.prototype={constructor:g,namespace:"featherlight",targetAttr:"data-featherlight",variant:null,resetCss:!1,background:null,openTrigger:"click",closeTrigger:"click",
filter:null,root:"body",openSpeed:250,closeSpeed:250,closeOnClick:"background",closeOnEsc:!0,closeIcon:"&#10005;",loading:"",persist:!1,otherClose:null,beforeOpen:d.noop,beforeContent:d.noop,beforeClose:d.noop,afterOpen:d.noop,afterContent:d.noop,afterClose:d.noop,onKeyUp:d.noop,onResize:d.noop,type:null,contentFilters:"jquery image html ajax iframe text".split(" "),setup:function(a,b){"object"!==typeof a||!1!==a instanceof d||b||(b=a,a=void 0);var c=d.extend(this,b,{target:a}),e=c.resetCss?c.namespace+
"-reset":c.namespace;e=d(c.background||['<div class="'+e+"-loading "+e+'">','<div class="'+e+'-content">','<button class="'+e+"-close-icon "+c.namespace+'-close" aria-label="Close">',c.closeIcon,"</button>",'<div class="'+c.namespace+'-inner">'+c.loading+"</div>","</div></div>"].join(""));var f="."+c.namespace+"-close"+(c.otherClose?","+c.otherClose:"");c.$instance=e.clone().addClass(c.variant);c.$instance.on(c.closeTrigger+"."+c.namespace,function(a){if(!a.isDefaultPrevented()){var b=d(a.target);
if("background"===c.closeOnClick&&b.is("."+c.namespace)||"anywhere"===c.closeOnClick||b.closest(f).length)c.close(a),a.preventDefault()}});return this},getContent:function(){if(!1!==this.persist&&this.$content)return this.$content;var a=this.constructor.contentFilters,b=this.$currentTarget&&this.$currentTarget.attr(this.targetAttr),c=this.target||b||"",e=a[this.type];!e&&c in a&&(e=a[c],c=this.target&&b);c=c||this.$currentTarget&&this.$currentTarget.attr("href")||"";if(!e)for(var f in a)this[f]&&
(e=a[f],c=this[f]);if(!e){var h=c;c=null;d.each(this.contentFilters,function(){e=a[this];e.test&&(c=e.test(h));!c&&e.regex&&h.match&&h.match(e.regex)&&(c=h);return!c});if(!c)return"console"in window&&window.console.error("Featherlight: no content filter found "+(h?' for "'+h+'"':" (no target specified)")),!1}return e.process.call(this,c)},setContent:function(a){this.$instance.removeClass(this.namespace+"-loading");this.$instance.toggleClass(this.namespace+"-iframe",a.is("iframe"));this.$instance.find("."+
this.namespace+"-inner").not(a).slice(1).remove().end().replaceWith(d.contains(this.$instance[0],a[0])?"":a);this.$content=a.addClass(this.namespace+"-inner");return this},open:function(a){var b=this;b.$instance.hide().appendTo(b.root);if(!(a&&a.isDefaultPrevented()||!1===b.beforeOpen(a))){a&&a.preventDefault();var c=b.getContent();if(c)return k.push(b),q(!0),b.$instance.fadeIn(b.openSpeed),b.beforeContent(a),d.when(c).always(function(c){b.setContent(c);b.afterContent(a)}).then(b.$instance.promise()).done(function(){b.afterOpen(a)})}b.$instance.detach();
return d.Deferred().reject().promise()},close:function(a){var b=this,c=d.Deferred();!1===b.beforeClose(a)?c.reject():(0===n(b).length&&q(!1),b.$instance.fadeOut(b.closeSpeed,function(){b.$instance.detach();b.afterClose(a);c.resolve()}));return c.promise()},resize:function(a,b){if(a&&b){this.$content.css("width","").css("height","");var c=Math.max(a/(this.$content.parent().width()-1),b/(this.$content.parent().height()-1));1<c&&(c=b/Math.floor(b/c),this.$content.css("width",""+a/c+"px").css("height",
""+b/c+"px"))}},chainCallbacks:function(a){for(var b in a)this[b]=d.proxy(a[b],this,d.proxy(this[b],this))}};d.extend(g,{id:0,autoBind:"[data-featherlight]",defaults:g.prototype,contentFilters:{jquery:{regex:/^[#.]\w/,test:function(a){return a instanceof d&&a},process:function(a){return!1!==this.persist?d(a):d(a).clone(!0)}},image:{regex:/\.(png|jpg|jpeg|gif|tiff?|bmp|svg)(\?\S*)?$/i,process:function(a){var b=d.Deferred(),c=new Image,e=d('<img src="'+a+'" alt="" class="'+this.namespace+'-image" />');
c.onload=function(){e.naturalWidth=c.width;e.naturalHeight=c.height;b.resolve(e)};c.onerror=function(){b.reject(e)};c.src=a;return b.promise()}},html:{regex:/^\s*<[\w!][^<]*>/,process:function(a){return d(a)}},ajax:{regex:/./,process:function(a){var b=d.Deferred(),c=d("<div></div>").load(a,function(a,d){"error"!==d&&b.resolve(c.contents());b.fail()});return b.promise()}},iframe:{process:function(a){var b=new d.Deferred,c=d("<iframe/>"),e=t(this,"iframe"),f=r(e,u);c.hide().attr("src",a).attr(f).css(e).on("load",
function(){b.resolve(c.show())}).appendTo(this.$instance.find("."+this.namespace+"-content"));return b.promise()}},text:{process:function(a){return d("<div>",{text:a})}}},functionAttributes:"beforeOpen afterOpen beforeContent afterContent beforeClose afterClose".split(" "),readElementConfig:function(a,b){var c=this,e=new RegExp("^data-"+b+"-(.*)"),f={};a&&a.attributes&&d.each(a.attributes,function(){var a=this.name.match(e);if(a){var b=this.value;a=d.camelCase(a[1]);if(0<=d.inArray(a,c.functionAttributes))b=
new Function(b);else try{b=JSON.parse(b)}catch(w){}f[a]=b}});return f},extend:function(a,b){var c=function(){this.constructor=a};c.prototype=this.prototype;a.prototype=new c;a.__super__=this.prototype;d.extend(a,this,b);a.defaults=a.prototype;return a},attach:function(a,b,c){var e=this;"object"!==typeof b||!1!==b instanceof d||c||(c=b,b=void 0);c=d.extend({},c);var f=d.extend({},e.defaults,e.readElementConfig(a[0],c.namespace||e.defaults.namespace),c),h,g=function(g){var k=d(g.currentTarget),m=d.extend({$source:a,
$currentTarget:k},e.readElementConfig(a[0],f.namespace),e.readElementConfig(g.currentTarget,f.namespace),c),l=h||k.data("featherlight-persisted")||new e(b,m);"shared"===l.persist?h=l:!1!==l.persist&&k.data("featherlight-persisted",l);m.$currentTarget.blur&&m.$currentTarget.blur();l.open(g)};a.on(f.openTrigger+"."+f.namespace,f.filter,g);return{filter:f.filter,handler:g}},current:function(){var a=this.opened();return a[a.length-1]||null},opened:function(){var a=this;n();return d.grep(k,function(b){return b instanceof
a})},close:function(a){var b=this.current();if(b)return b.close(a)},_onReady:function(){var a=this;if(a.autoBind){var b=d(a.autoBind);b.each(function(){a.attach(d(this))});d(document).on("click",a.autoBind,function(c){if(!c.isDefaultPrevented()){var e=d(c.currentTarget),f=b.length;b=b.add(e);f!==b.length&&(f=a.attach(e),(!f.filter||0<d(c.target).parentsUntil(e,f.filter).length)&&f.handler(c))}})}},_callbackChain:{onKeyUp:function(a,b){return 27===b.keyCode?(this.closeOnEsc&&d.featherlight.close(b),
!1):a(b)},beforeOpen:function(a,b){d(document.documentElement).addClass("with-featherlight");this._previouslyActive=document.activeElement;this._$previouslyTabbable=d("a, input, select, textarea, iframe, button, iframe, [contentEditable=true]").not("[tabindex]").not(this.$instance.find("button"));this._$previouslyWithTabIndex=d("[tabindex]").not('[tabindex="-1"]');this._previousWithTabIndices=this._$previouslyWithTabIndex.map(function(a,b){return d(b).attr("tabindex")});this._$previouslyWithTabIndex.add(this._$previouslyTabbable).attr("tabindex",
-1);document.activeElement.blur&&document.activeElement.blur();return a(b)},afterClose:function(a,b){var c=a(b),e=this;this._$previouslyTabbable.removeAttr("tabindex");this._$previouslyWithTabIndex.each(function(a,b){d(b).attr("tabindex",e._previousWithTabIndices[a])});this._previouslyActive.focus();0===g.opened().length&&d(document.documentElement).removeClass("with-featherlight");return c},onResize:function(a,b){this.resize(this.$content.naturalWidth,this.$content.naturalHeight);return a(b)},afterContent:function(a,
b){var c=a(b);this.$instance.find("[autofocus]:not([disabled])").focus();this.onResize(b);return c}}});d.featherlight=g;d.fn.featherlight=function(a,b){g.attach(this,a,b);return this};d(document).ready(function(){g._onReady()})}})(jQuery);